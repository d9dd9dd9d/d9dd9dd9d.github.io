

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>QFT and DQFT (double precision) classes &mdash; Mark&#39;s Notebook  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Simple peak follower" href="19-simple-peak-follower.html" />
    <link rel="prev" title="Measuring interpollation noise" href="22-measuring-interpollation-noise.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Mark's Notebook
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Analysis</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="200-beat-detector-class.html">Beat Detector Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="20-coefficients-for-daubechies-wavelets-1-38.html">Coefficients for Daubechies wavelets 1-38</a></li>
<li class="toctree-l2"><a class="reference internal" href="21-dft.html">DFT</a></li>
<li class="toctree-l2"><a class="reference internal" href="97-envelope-detector.html">Envelope detector</a></li>
<li class="toctree-l2"><a class="reference internal" href="136-envelope-follower-with-different-attack-and-release.html">Envelope follower with different attack and release</a></li>
<li class="toctree-l2"><a class="reference internal" href="79-fft.html">FFT</a></li>
<li class="toctree-l2"><a class="reference internal" href="82-fft-classes-in-c-and-object-pascal.html">FFT classes in C++ and Object Pascal</a></li>
<li class="toctree-l2"><a class="reference internal" href="18-fast-in-place-walsh-hadamard-transform.html">Fast in-place Walsh-Hadamard Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="186-frequency-response-from-biquad-coefficients.html">Frequency response from biquad coefficients</a></li>
<li class="toctree-l2"><a class="reference internal" href="156-java-fft.html">Java FFT</a></li>
<li class="toctree-l2"><a class="reference internal" href="137-lpc-analysis-autocorrelation-levinson-durbin-recursion.html">LPC analysis (autocorrelation + Levinson-Durbin recursion)</a></li>
<li class="toctree-l2"><a class="reference internal" href="53-look-ahead-limiting.html">Look ahead limiting</a></li>
<li class="toctree-l2"><a class="reference internal" href="108-magnitude-and-phase-plot-of-arbitrary-iir-function-up-to-5th-order.html">Magnitude and phase plot of arbitrary IIR function, up to 5th order</a></li>
<li class="toctree-l2"><a class="reference internal" href="22-measuring-interpollation-noise.html">Measuring interpollation noise</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">QFT and DQFT (double precision) classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="19-simple-peak-follower.html">Simple peak follower</a></li>
<li class="toctree-l2"><a class="reference internal" href="107-tone-detection-with-goertzel.html">Tone detection with Goertzel</a></li>
<li class="toctree-l2"><a class="reference internal" href="172-tone-detection-with-goertzel-x86-asm.html">Tone detection with Goertzel (x86 ASM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="264-vintage-vu-meters-tutorial.html">Vintage VU meters tutorial</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../test/index.html">test</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Mark's Notebook</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Analysis</a> &raquo;</li>
        
      <li>QFT and DQFT (double precision) classes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/d9dd9dd9d/d9dd9dd9d.github.io/blob/master/source/Analysis/146-qft-and-dqft-double-precision-classes.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="qft-and-dqft-double-precision-classes">
<h1>QFT and DQFT (double precision) classes<a class="headerlink" href="#qft-and-dqft-double-precision-classes" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><strong>Author or source:</strong> Joshua Scholar</p></li>
<li><p><strong>Created:</strong> 2003-05-17 16:17:35</p></li>
<li><p><strong>Linked files:</strong> <a class="reference download internal" download="" href="../_downloads/83cbfe1ae4c4f6a1006a34c953e74e7b/qft.tar_1.gz"><code class="xref download docutils literal notranslate"><span class="pre">qft.tar_1.gz</span></code></a>.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">notes</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Since it&#39;s a Visual C++ project (though it has relatively portable C++) I
guess the main audience are PC users.  As such I&#39;m including a zip file.
Some PC users wouldn&#39;t know what to do with a tgz file.

The QFT and DQFT (double precision) classes supply the following functions:

  1. Real valued FFT and inverse FFT functions.  Note that separate arraysare used
     for real and imaginary component of the resulting spectrum.

  2. Decomposition of a spectrum into a separate spectrum of the evensamples
     and a spectrum of the odd samples.  This can be useful for buildingfilter banks.

  3. Reconstituting a spectrum from separate spectrums of the even samples
     and odd samples.  This can be useful for building filter banks.

  4. A discrete Sin transform (a QFT decomposes an FFT into a DST and DCT).

  5. A discrete Cos transfrom.

  6. Since a QFT does it&#39;s last stage calculating from the outside in thelast part
     can be left unpacked and only calculated as needed in the case wherethe entire
  spectrum isn&#39;t needed (I used this for calculating correlations andconvolutions
  where I only needed half of the results).
  ReverseNoUnpack()
  UnpackStep()
  and NegUnpackStep()
  implement this functionality

  NOTE Reverse() normalizes its results (divides by one half the blocklength), but
  ReverseNoUnpack() does not.

  7. Also if you only want the first half of the results you can call ReverseHalf()

  NOTE Reverse() normalizes its results (divides by one half the blocklength), but
  ReverseHalf() does not.

  8. QFT is less numerically stable than regular FFTs.  With singleprecision calculations,
     a block length of 2^15 brings the accuracy down to being barelyaccurate enough.
  At that size, single precision calculations tested sound files wouldoccasionally have
  a sample off by 2, and a couple off by 1 per block. Full volume whitenoise would
generate
  a few samples off by as much as 6 per block at the end, beginning and middle.

  No matter what the inputs the errors are always at the same positions in the block.
  There some sort of cancelation that gets more delicate as the block size gets bigger.

  For the sake of doing convolutions and the like where the forward transform is
  done only once for one of the inputs, I created a AccurateForward() function.
  It uses a regular FFT algorithm for blocks larger than 2^12, and decomposes into even
and
  odd FFTs recursively.

  In any case you can always use the double precision routines to get more accuracy.
  DQFT even has routines that take floats as inputs and return double precision
  spectrum outputs.

As for portability:

1. The files qft.cpp and dqft.cpp start with defines:
#define _USE_ASM

If you comment those define out, then what&#39;s left is C++ with no assembly language.

2. There is unnecessary windows specific code in &quot;criticalSection.h&quot;
I used a critical section because objects are not reentrant (each object has
permanent scratch pad memory), but obviously critical sections are operating
system specific.  In any case that code can easily be taken out.


If you look at my code and see that there&#39;s an a test built in the examples
that makes sure that the results are in the ballpark of being right. It
wasn&#39;t that I expected the answers to be far off, it was that I uncommenting
the &quot;no assembly language&quot; versions of some routines and I wanted to make
sure that they weren&#39;t broken.
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="19-simple-peak-follower.html" class="btn btn-neutral float-right" title="Simple peak follower" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="22-measuring-interpollation-noise.html" class="btn btn-neutral float-left" title="Measuring interpollation noise" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Mark&#39;s Notebook

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>